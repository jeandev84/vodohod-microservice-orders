# Водоход Микросервис Заказа


Краткое описание задачи
```
Задание:

Нужно спроектироdать микросервис для простого создания закаpа на основе корзины
Сервис должен состоять из 1 метода POST / orders
На входе должен быть json вида

{
  «email»: «валидный e-mail заказчика»,
  «cart»: [ тут массив неких CartItem, например книг ]
}

пример CartItem { isbn : string , count :int } — ISBN книги и цена
Метод отвечает код 200 и в ответе ID заказа
{
   «order_id»: 12345
}

или 400, если ошибки валидации - ответом с ошибками валидации можно пренебречь
Нужно создать структуру приложения на Symfony или любого другого фрейморка или голом PHP.

Использовать принципы:
- SOLID
- DDD
- тонкий контроллер

Описать валидаторы, клиентский код, для конечных логик достаточно написать сигнатуры всех методов, описать интерфейсе, DTO и фабрики
Желательно приложить структуру таблиц в реляционной БД (самый простым списком - таблица и атрибуты)
Т.к. это микросервис заказов - информацию о книгах он не хранит, 
со-но нам нужно как-то узнать существует ли такой ISBN, 
и есть ли на складе запрашиваемое количество.
```

## Требования

```
PHP >=8.1
Composer
```


## Установка 

1. Выполняем в терминале ```composer install``` чтобы собрать все зависимости нашего приложения.
2. Если вы на линуксе (Lunix) выполняете ```сp .env .env.local``` или просто создавать в ручную ```.env.local```:
3. Далее настраиваете файл ```.env.local``` в след. образом, главное как минимум настроить подключение к базе данных в моем случаи ипользую ```postgresql```
```
###> symfony/framework-bundle ###
APP_ENV=dev
APP_SECRET=f1491f07cb3f35eaeb8613963b9f6691
###< symfony/framework-bundle ###

###> doctrine/doctrine-bundle ###
....
# DATABASE_URL="mysql://app:!ChangeMe!@127.0.0.1:3306/app?serverVersion=10.11.2-MariaDB&charset=utf8mb4"
DATABASE_URL="postgresql://YOUR_USERNAME:YOUR_PASSWORD@127.0.0.1:5432/YOUR_DATABASE?serverVersion=16&charset=utf8"
###< doctrine/doctrine-bundle ###
```
4. После чего, создаете вашу базу данных или ваш ```homestand``` так называемое, при помощи следующей команды:
```bash  
php bin/console doctrine:database:create
```

5. Далее выполняете миграцию чтобы накатить ваши таблицы при помощи след. команды: 
```bash
php bin/console database:migrations:migrate
```


6. После чего можете запускать внутрение сервак симфони при помощи след. команды:
```bash
php -S localhost:8000 -t public -d display_errors=1
```
или
включите OPCache итд...
```bash
env ENV=dev php -S localhost:8000 -t public -d display_errors=1 -d opcache.enable_cli=1
```

Если у вас внутрение сервер симфони можете через него запускать проект 

7. После чего у вас будет сервер случит на порт ```:8000``` конечно если порт не занят.

8. Теперь вы можете через ```POSTMAN``` или любой другой инструмент 

9. По методу ```POST``` отправляем HTTP запрос, чтобы создавать заказ :
```php 
POST  http://127.0.0.1:8001/api/v1/orders

Тело запроса (Parsed Body) например:
{
    "email": "john@doe.ru",
    "cart" : [
        {
            "isbn": "ISBN-13: 978-1-56619-909-3",
            "count": 3
        },
        {
            "isbn": "ISBN-14: 978-1-56619-909-4",
            "count": 5
        }
    ]
}

и смотрим Тело ответа (Reponse Body)
если заказ создался то получите такой json например
{
    "orderId": 5,
    "error": null,
    "statusCode": 201
}

в случае ошибки
{
    "orderId": null,
    "error": "Проблема какая-то с валидацей данных ...",
    "statusCode": 400
}

```

В общем как-то так работает.

10. Желаю вам хорошего испытания:)
11. Исходники в папке ```./src``` приложения
12. Есть какие-то скриншоты в папке ```./screenshorts```